<div *ngIf="eventDetails" class="complete-event-wrapper">
  <div class="display-align">
    <div class="event-page-heading">{{eventDetails?.name | titlecase}}
      <span class="event-id">(EVNT #{{eventDetails.id}})</span>
      <span *ngIf="!eventDetails?.isHighLighted" class="highlighted">(Event is not highlighted)</span>
    </div>
    <div>
      <button class="btn btn-primary btn-raised" (click)="goBack()">
        <!-- <img src="../../../../assets/img/svg/left-arrow.svg" style="width: 15px; margin-right: 10px;"/>
        Back -->
        <i class="fa fa-long-arrow-left" aria-hidden="true">
          <span class="ml-1">Back</span></i>
      </button>
    </div>
  </div>

  <!--..........section for complete details of event................  -->
  <div class="event-details-wrapper">
    <div class="event-columns">
      <div class="event-row">
        <p class="field-name">Category:</p>
        <p class="field-details">{{categoryName}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Organiser:</p>
        <p class="field-details">{{eventDetails?.users?.name ? eventDetails?.users?.name : 'N/A'}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Event type:</p>
        <p class="field-details">{{eventDetails?.eventType == 1 ? 'Paid' : '' || eventDetails?.eventType == 0 ? 'Free' :
          '' || eventDetails?.eventType == 2 ? 'System Tickets' : ''}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Event Start:</p>
        <p class="field-details">{{eventDetails?.start | date: 'MMMM d, y'}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Event End:</p>
        <p class="field-details">{{eventDetails?.end | date: 'MMMM d, y'}}</p>
      </div>
      <div class="event-row">
        <p class="field-name">Frequency of Event:</p>
        <p class="field-details">{{eventDetails?.eventOccurrence[0]?.eventOccurrence}}</p>
      </div>
    </div>

    <div class="event-columns">
      <div class="event-row">
        <p class="field-name">Sub-Category:</p>
        <p class="field-details">{{subCategoryName}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Like Count:</p>
        <p class="field-details">{{eventDetails?.userLikeCount ? eventDetails?.userLikeCount : 0}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Dislike Count:</p>
        <p class="field-details">{{eventDetails?.userDisLikeCount ? eventDetails?.userDisLikeCount : 0}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Selling Start:</p>
        <p class="field-details" [pTooltip]="sellingStartDate">{{sellingStartDate ? sellingStartDate : 'N/A'}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Selling End:</p>
        <p class="field-details" [pTooltip]="sellingEndDate">{{sellingEndDate ? sellingEndDate : 'N/A'}}</p>
      </div>

    </div>

    <div class="event-columns">
      <div class="event-row">
        <p class="field-name">Users Attending:</p>
        <p class="field-details">{{eventDetails?.attendeescount == null ? 0 :
          eventDetails?.attendeescount}}/{{eventDetails?.actualquantity}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Location:
          <a href="javascript: void(0)" class="link" (click)="goToVenueDetail()">(View venue)</a>
        </p>
        <p class="field-details">
          {{eventDetails?.venueEvents[0]?.venueAddress ? eventDetails?.venueEvents[0]?.venueAddress : 'N/A'}}
        </p>
      </div>

      <div class="event-row">
        <p class="field-name">Helpline No:</p>
        <p class="field-details">{{eventDetails?.eventHelpLine ? eventDetails?.eventHelpLine : 'N/A'}}</p>
      </div>

      <div class="event-row">
        <p class="field-name">Uploaded Images:</p>
        <img style="height: 25px;" *ngFor="let image of eventDetails?.eventImages; let i = index"
          [src]="image.eventImage" class="start-icon" (click)="showImageDialog(image)" />
      </div>
    </div>
  </div>
  <div class="event-row">
    <p class="field-name width-fix">Description:</p>
    <p class="description-details">{{eventDetails.description ? eventDetails.description : 'N/A'}}</p>
  </div>
  <div class="col-md-3">
    <button *ngIf="eventDetails.isArchived == false" class="btn btn-primary btn-raised" (click)="archiveStatusChange(eventDetails.id, eventDetails.isArchived)">Archive</button>
    &nbsp;&nbsp;
    <button *ngIf="eventDetails.isArchived == true" class="btn btn-danger btn-raised" type="button" (click)="archiveStatusChange(eventDetails.id, eventDetails.isArchived)">Unarchive</button>
  </div>
  <div class=" bg-white">
    <p-table #dt [columns]="cols" [value]="attendeesList" [responsive]="true" styleClass="faq-table table-align"
      [paginator]="true" [rows]="8" [alwaysShowPaginator]="false">
      <ng-template pTemplate="caption">
        <div class="ui-helper-clearfix">
          <p class="heading">Attending Users</p>
          <div class="row">
            <div class="col-sm-8">
              <div class="row">
                <div class="col-sm-7">
                  <input type="text" pInputText size="40" placeholder="Customer Search..."
                    (input)="searchAttendeesList($event)" class="form-control mb-2" style="width: 100%;">
                </div>
                <div class="col-sm-5  text-left">
                  <div>
                    <p-dropdown [options]="sortByArray" [(ngModel)]="selectedSortBy" optionLabel="name"
                      (onChange)="selectSortValue($event)" placeholder='Sort By'></p-dropdown>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-sm-4">
              <button type="button" pButton icon="fa fa-file-o" iconPos="left" label="Export CSV"
                style="float:right; background-color: #8e71b5;" (click)="exportData()">
              </button>
            </div>
          </div>
        </div>

      </ng-template>

      <ng-template pTemplate="header">
        <tr>
          <th style="width: 8%;">Sr.No.</th>
          <th style="width: 16%;">Name</th>
          <th style="width: 20%;">Email</th>
          <th style="width: 15%;">Phone Number</th>
          <th style="width: 12%;">Ticket</th>
          <th style="width: 20%;">Address</th>
          <th style="width: 10%;">View</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item let-key let-i="rowIndex">
        <tr>
          <td>{{ i + 1 }}</td>
          <td><span class="ui-column-title">Name</span>{{item?.users?.name ? item?.users?.name : 'N/A'}}</td>
          <td><span class="ui-column-title">Email</span>{{item?.users?.email ? item?.users?.email : 'N/A'}}</td>
          <td><span class="ui-column-title">Phone Number</span>{{item?.users?.phoneNo ? item?.users?.phoneNo : 'N/A'}}
          </td>

          <td class="action-buttons">
            <span class="ui-column-title">Ticket</span>
            <button style="min-width: 3em;color: #066b06;
          " class="custom-btn custom-btn-small blue-btn text-center edit" (click)="showTicketDialog(item)"><i
                class="fa fa-ticket" aria-hidden="true"></i></button>
          </td>
          <td><span class="ui-column-title">Address</span>{{item?.users?.address ? item?.users?.address : 'N/A'}}</td>
          <td class="action-buttons">
            <span class="ui-column-title">View</span>
            <button class="custom-btn custom-btn-small blue-btn text-center edit"
              style=" margin-right: 4px !important;min-width: 4em !important;height: 2.4em !important; color:#ce0017"
              (click)="showTicketDialog(item)">
              <i class="fa fa-eye" aria-hidden="true"></i></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td class="text-center text-danger" colspan="8">No Record Found.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <p-paginator [rows]="10" [totalRecords]="totalRecords" (onPageChange)="paginate($event)"></p-paginator>
</div>
<p-dialog [draggable]="false" modal="true" [responsive]="true" [style]="{minWidth: '800px'}" appendTo="body"
  blockScroll="true" showHeader="false" [(visible)]="showImageModal">
  <img style="height: 500px;width: 800px" [src]="imageURL" />
</p-dialog>
<p-dialog [draggable]="false" modal="true" [responsive]="true" [style]="{minWidth: '800px'}" appendTo="body"
  blockScroll="true" showHeader="false" [(visible)]="showTicketModalDetails">
  <img [src]="ticketImage" class="img-modal" />
  <div class="overlay">
    <div class="overlay-content">
      <h2 class="overlay-heading">{{eventDetails?.name | titlecase}}</h2>
      <p class="overlay-id">Event Code #{{eventDetails?.eventCode}}</p>
      <p class="overlay-details">
        <img src="../../../../../assets/img/svg/time.svg" class="overlay-icon" />
        {{eventDetails?.start | date: 'd MMM y'}} | {{eventDetails?.start | date: 'h:mm a'}} - {{eventDetails?.end |
        date: 'h:mm a'}}
      </p>
      <p class="overlay-details">
        <img src="../../../../../assets/img/svg/location.svg" class="overlay-icon" />
        {{eventDetails?.venueEvents[0]?.venueAddress}}
      </p>
      <p class="overlay-details">
        <img src="../../../../../assets/img/svg/time.svg" class="overlay-icon" />
        {{ticketDetails?.ticketquantity}} {{ticketDetails?.ticket_info[0]?.ticketType}} ${{ticketDetails?.totalprice}}
      </p>
      <p class="overlay-id mt-3">{{ticketDetails?.ticket_number_booked_rel.length > 1 ? 'Purchased in a group Ticket 1
        of ' + ticketDetails?.ticket_number_booked_rel.length : ''}}</p>
      <p class="overlay-details">{{ticketDetails?.ticket_info[0]?.ticketName}}</p>
      <p class="overlay-ticket">
        <img src="../../../../../assets/img/svg/qr-code.svg" class="overlay-icon-qr" />
        {{ticketDetails?.ticket_info[0]?.ticketNumber | uppercase}}
        <img src="../../../../../assets/img/svg/share.svg" class="overlay-icon-share" />
      </p>
    </div>
  </div>
</p-dialog>